<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mission CC Poster Generator</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>Mission CC Poster Generator</h1>
            <p>Developed by <a href="https://www.instagram.com/shahin.shadi_ck/">Shahin.Shadi_ck</a></p>
        </div>

        <div class="form-container">
            <div class="form-grid">
                <!-- Post 1 -->
                <div class="form-section">
                    <h3>Post 1</h3>
                    <div class="form-group">
                        <label>Author Name:</label>
                        <input type="text" id="author1" placeholder="Author Name">
                    </div>
                    <div class="form-group">
                        <label>Publication:</label>
                        <textarea id="pubText1"
                            placeholder="Text after author name">Congratulations for publishing an article in keraleeyam magazine.</textarea>
                    </div>
                    <div class="form-group">
                        <label>Publication Number:</label>
                        <input type="text" id="link1" placeholder="e.g. 1">
                    </div>
                    <div class="form-group">
                        <label>Publication Image:</label>
                        <div class="file-input">
                            <input type="file" id="pubImg1" accept="image/*">
                            <label class="file-input-label" for="pubImg1">Choose Publication Image</label>
                        </div>
                        <div class="preview-container" id="pubPreview1"></div>
                    </div>
                    <div class="form-group">
                        <label>Author Image:</label>
                        <div class="file-input">
                            <input type="file" id="authImg1" accept="image/*">
                            <label class="file-input-label" for="authImg1">Choose Author Image</label>
                        </div>
                        <div class="preview-container" id="authPreview1"></div>
                    </div>
                </div>

                <!-- Post 2 -->
                <div class="form-section">
                    <h3>Post 2</h3>
                    <div class="form-group">
                        <label>Author Name:</label>
                        <input type="text" id="author2" placeholder="Author Name">
                    </div>
                    <div class="form-group">
                        <label>Publication:</label>
                        <textarea id="pubText2"
                            placeholder="Text after author name">Congratulations for publishing an article in keraleeyam magazine.</textarea>
                    </div>
                    <div class="form-group">
                        <label>Publication Number:</label>
                        <input type="text" id="link2" placeholder="e.g. 2">
                    </div>
                    <div class="form-group">
                        <label>Publication Image:</label>
                        <div class="file-input">
                            <input type="file" id="pubImg2" accept="image/*">
                            <label class="file-input-label" for="pubImg2">Choose Publication Image</label>
                        </div>
                        <div class="preview-container" id="pubPreview2"></div>
                    </div>
                    <div class="form-group">
                        <label>Author Image:</label>
                        <div class="file-input">
                            <input type="file" id="authImg2" accept="image/*">
                            <label class="file-input-label" for="authImg2">Choose Author Image</label>
                        </div>
                        <div class="preview-container" id="authPreview2"></div>
                    </div>
                </div>

                <!-- Post 3 -->
                <div class="form-section">
                    <h3>Post 3</h3>
                    <div class="form-group">
                        <label>Author Name:</label>
                        <input type="text" id="author3" placeholder="Author Name">
                    </div>
                    <div class="form-group">
                        <label>Publication:</label>
                        <textarea id="pubText3"
                            placeholder="Text after author name">Congratulations for publishing an article in keraleeyam magazine.</textarea>
                    </div>
                    <div class="form-group">
                        <label>Publication Number:</label>
                        <input type="text" id="link3" placeholder="e.g. 3">
                    </div>
                    <div class="form-group">
                        <label>Publication Image:</label>
                        <div class="file-input">
                            <input type="file" id="pubImg3" accept="image/*">
                            <label class="file-input-label" for="pubImg3">Choose Publication Image</label>
                        </div>
                        <div class="preview-container" id="pubPreview3"></div>
                    </div>
                    <div class="form-group">
                        <label>Author Image:</label>
                        <div class="file-input">
                            <input type="file" id="authImg3" accept="image/*">
                            <label class="file-input-label" for="authImg3">Choose Author Image</label>
                        </div>
                        <div class="preview-container" id="authPreview3"></div>
                    </div>
                </div>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Generating posters...</p>
            </div>

            <button class="generate-btn" id="generateBtn">Generate Posters</button>

            <div class="poster-preview" id="posterPreview">
                <h3>Landscape Poster Preview</h3>
                <canvas class="poster-canvas" id="posterCanvas"></canvas>

                <h3 style="margin-top: 40px;">Portrait Posters Preview</h3>
                <div class="portrait-previews">
                    <div class="portrait-preview-item">
                        <h4>Post 1</h4>
                        <canvas class="portrait-canvas" id="portraitCanvas1"></canvas>
                    </div>
                    <div class="portrait-preview-item">
                        <h4>Post 2</h4>
                        <canvas class="portrait-canvas" id="portraitCanvas2"></canvas>
                    </div>
                    <div class="portrait-preview-item">
                        <h4>Post 3</h4>
                        <canvas class="portrait-canvas" id="portraitCanvas3"></canvas>
                    </div>
                </div>

                <div class="download-section">
                    <button class="generate-btn" id="downloadLandscape">Download Landscape Poster</button>
                    <div class="download-btn-group">
                        <button class="generate-btn" id="downloadPost1">Download Post 1</button>
                        <button class="generate-btn" id="downloadPost2">Download Post 2</button>
                        <button class="generate-btn" id="downloadPost3">Download Post 3</button>
                    </div>
                    <button class="generate-btn" id="downloadAll">Download All (ZIP)</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden posters for high-res generation -->
    <div class="hidden-poster" id="hiddenPoster">
        <img id="posterBG" src="" alt="">

        <img class="publication" id="pub1" src="" alt="">
        <img class="author-img" id="auth1" src="" alt="">
        <p class="author" id="authorText1"><span></span></p>
        <p class="link" id="linkText1"></p>

        <img class="publication second-post" id="pub2" src="" alt="">
        <img class="author-img second-post" id="auth2" src="" alt="">
        <p class="author second-post" id="authorText2"><span></span></p>
        <p class="link second-post" id="linkText2"></p>

        <img class="publication third-post" id="pub3" src="" alt="">
        <img class="author-img third-post" id="auth3" src="" alt="">
        <p class="author third-post" id="authorText3"><span></span></p>
        <p class="link third-post" id="linkText3"></p>
    </div>

    <!-- Portrait posters -->
    <div class="portrait-poster" id="portraitPoster1">
        <img id="portraitBG1" src="" alt="">
        <img class="publication" id="portraitPub1" src="" alt="">
        <img class="author-img" id="portraitAuth1" src="" alt="">
        <p class="author" id="portraitAuthorText1"><span></span></p>
        <p class="link" id="portraitLinkText1"></p>
    </div>

    <div class="portrait-poster" id="portraitPoster2">
        <img id="portraitBG2" src="" alt="">
        <img class="publication" id="portraitPub2" src="" alt="">
        <img class="author-img" id="portraitAuth2" src="" alt="">
        <p class="author" id="portraitAuthorText2"><span></span></p>
        <p class="link" id="portraitLinkText2"></p>
    </div>

    <div class="portrait-poster" id="portraitPoster3">
        <img id="portraitBG3" src="" alt="">
        <img class="publication" id="portraitPub3" src="" alt="">
        <img class="author-img" id="portraitAuth3" src="" alt="">
        <p class="author" id="portraitAuthorText3"><span></span></p>
        <p class="link" id="portraitLinkText3"></p>
    </div>

    <div class="crop-popup" id="cropPopup">
        <div class="crop-popup-content">
            <div class="crop-popup-header">
                <h3 id="cropPopupTitle">Crop Image</h3>
                <button class="crop-popup-close" onclick="closeCropPopup()">&times;</button>
            </div>
            <div id="cropPopupBody"></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        class PosterGenerator {
            constructor() {
                this.croppedImages = {};
                this.setupEventListeners();
            }

            setupEventListeners() {
                for (let i = 1; i <= 3; i++) {
                    document.getElementById(`pubImg${i}`).addEventListener('change', (e) => this.handleImageUpload(e, 'publication', i));
                    document.getElementById(`authImg${i}`).addEventListener('change', (e) => this.handleImageUpload(e, 'author', i));
                }

                document.getElementById('generateBtn').addEventListener('click', () => this.generatePoster());
                document.getElementById('downloadLandscape').addEventListener('click', () => this.downloadLandscape());
                document.getElementById('downloadPost1').addEventListener('click', () => this.downloadPortrait(1));
                document.getElementById('downloadPost2').addEventListener('click', () => this.downloadPortrait(2));
                document.getElementById('downloadPost3').addEventListener('click', () => this.downloadPortrait(3));
                document.getElementById('downloadAll').addEventListener('click', () => this.downloadAll());
            }

            handleImageUpload(event, type, index) {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        this.showImageCropper(img, type, index);
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }

            showImageCropper(img, type, index) {
                let targetWidth, targetHeight;
                if (type === 'publication') {
                    targetWidth = 713;
                    targetHeight = 713;
                } else if (type === 'author') {
                    targetWidth = 199;
                    targetHeight = 254;
                }

                const popup = document.getElementById('cropPopup');
                const popupBody = document.getElementById('cropPopupBody');
                const popupTitle = document.getElementById('cropPopupTitle');

                popupTitle.textContent = `Crop ${type === 'publication' ? 'Publication' : 'Author'} Image`;
                popupBody.innerHTML = '';

                const maxDisplaySize = 400;
                const displayScale = Math.min(maxDisplaySize / img.width, maxDisplaySize / img.height);
                const displayWidth = img.width * displayScale;
                const displayHeight = img.height * displayScale;

                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = displayWidth;
                canvas.height = displayHeight;
                ctx.drawImage(img, 0, 0, displayWidth, displayHeight);

                const canvasContainer = document.createElement('div');
                canvasContainer.className = 'canvas-container';
                canvasContainer.appendChild(canvas);

                const targetAspect = targetWidth / targetHeight;
                const imgAspect = img.width / img.height;

                let initialCropWidth, initialCropHeight;
                if (imgAspect > targetAspect) {
                    initialCropHeight = displayHeight * 0.8;
                    initialCropWidth = initialCropHeight * targetAspect;
                } else {
                    initialCropWidth = displayWidth * 0.8;
                    initialCropHeight = initialCropWidth / targetAspect;
                }

                const initialCropX = (displayWidth - initialCropWidth) / 2;
                const initialCropY = (displayHeight - initialCropHeight) / 2;

                const cropOverlay = document.createElement('div');
                cropOverlay.className = 'crop-overlay';
                cropOverlay.style.left = initialCropX + 'px';
                cropOverlay.style.top = initialCropY + 'px';
                cropOverlay.style.width = initialCropWidth + 'px';
                cropOverlay.style.height = initialCropHeight + 'px';

                const cropHandle = document.createElement('div');
                cropHandle.className = 'crop-handle';
                cropOverlay.appendChild(cropHandle);

                canvasContainer.appendChild(cropOverlay);

                this.makeDraggable(cropOverlay, canvasContainer);
                this.makeResizable(cropOverlay, cropHandle, targetAspect, canvasContainer);

                const cropTools = document.createElement('div');
                cropTools.className = 'crop-tools';

                const cropButton = document.createElement('button');
                cropButton.textContent = 'Apply Crop';
                cropButton.onclick = () => {
                    this.applyCrop(img, cropOverlay, canvas, type, index, targetWidth, targetHeight);
                    closeCropPopup();
                };

                const resetButton = document.createElement('button');
                resetButton.className = 'secondary';
                resetButton.textContent = 'Reset';
                resetButton.onclick = () => this.resetCrop(cropOverlay, initialCropX, initialCropY, initialCropWidth, initialCropHeight);

                const cancelButton = document.createElement('button');
                cancelButton.className = 'secondary';
                cancelButton.textContent = 'Cancel';
                cancelButton.onclick = () => closeCropPopup();

                cropTools.appendChild(cropButton);
                cropTools.appendChild(resetButton);
                cropTools.appendChild(cancelButton);

                popupBody.appendChild(canvasContainer);
                popupBody.appendChild(cropTools);

                popup.classList.add('show');
            }

            makeDraggable(element, container) {
                let isDragging = false;
                let startX, startY, initialX, initialY;

                element.addEventListener('mousedown', (e) => {
                    if (e.target.classList.contains('crop-handle')) return;

                    isDragging = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    initialX = element.offsetLeft;
                    initialY = element.offsetTop;

                    document.addEventListener('mousemove', drag);
                    document.addEventListener('mouseup', stopDrag);
                });

                function drag(e) {
                    if (!isDragging) return;

                    const dx = e.clientX - startX;
                    const dy = e.clientY - startY;

                    let newX = initialX + dx;
                    let newY = initialY + dy;

                    newX = Math.max(0, Math.min(newX, container.offsetWidth - element.offsetWidth));
                    newY = Math.max(0, Math.min(newY, container.offsetHeight - element.offsetHeight));

                    element.style.left = newX + 'px';
                    element.style.top = newY + 'px';
                }

                function stopDrag() {
                    isDragging = false;
                    document.removeEventListener('mousemove', drag);
                    document.removeEventListener('mouseup', stopDrag);
                }
            }

            makeResizable(element, handle, targetAspect, container) {
                let isResizing = false;
                let startX, startY, initialWidth, initialHeight;

                handle.addEventListener('mousedown', (e) => {
                    isResizing = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    initialWidth = element.offsetWidth;
                    initialHeight = element.offsetHeight;

                    document.addEventListener('mousemove', resize);
                    document.addEventListener('mouseup', stopResize);
                    e.stopPropagation();
                });

                function resize(e) {
                    if (!isResizing) return;

                    const dx = e.clientX - startX;
                    let newWidth = initialWidth + dx;
                    let newHeight = newWidth / targetAspect;

                    const maxWidth = container.offsetWidth - element.offsetLeft;
                    const maxHeight = container.offsetHeight - element.offsetTop;

                    newWidth = Math.min(newWidth, maxWidth);
                    newHeight = Math.min(newHeight, maxHeight);

                    if (newWidth / targetAspect > newHeight) {
                        newWidth = newHeight * targetAspect;
                    } else {
                        newHeight = newWidth / targetAspect;
                    }

                    newWidth = Math.max(50, newWidth);
                    newHeight = Math.max(50, newHeight);

                    element.style.width = newWidth + 'px';
                    element.style.height = newHeight + 'px';
                }

                function stopResize() {
                    isResizing = false;
                    document.removeEventListener('mousemove', resize);
                    document.removeEventListener('mouseup', stopResize);
                }
            }

            applyCrop(img, cropOverlay, canvas, type, index, targetWidth, targetHeight) {
                const canvasRect = canvas.getBoundingClientRect();
                const overlayRect = cropOverlay.getBoundingClientRect();

                const scaleX = img.width / canvas.width;
                const scaleY = img.height / canvas.height;

                const cropX = (overlayRect.left - canvasRect.left) * scaleX;
                const cropY = (overlayRect.top - canvasRect.top) * scaleY;
                const cropWidth = overlayRect.width * scaleX;
                const cropHeight = overlayRect.height * scaleY;

                const croppedCanvas = document.createElement('canvas');
                const croppedCtx = croppedCanvas.getContext('2d');
                croppedCanvas.width = targetWidth;
                croppedCanvas.height = targetHeight;

                croppedCtx.drawImage(img, cropX, cropY, cropWidth, cropHeight, 0, 0, targetWidth, targetHeight);

                this.croppedImages[`${type}${index}`] = croppedCanvas.toDataURL();

                const previewId = type === 'publication' ? `pubPreview${index}` : `authPreview${index}`;
                const container = document.getElementById(previewId);
                container.innerHTML = '';

                const previewCanvas = document.createElement('canvas');
                const previewCtx = previewCanvas.getContext('2d');
                const previewSize = 150;
                previewCanvas.width = previewSize;
                previewCanvas.height = previewSize * (targetHeight / targetWidth);

                previewCtx.drawImage(croppedCanvas, 0, 0, previewCanvas.width, previewCanvas.height);
                container.appendChild(previewCanvas);

                const successMsg = document.createElement('div');
                successMsg.textContent = 'âœ“ Crop applied successfully';
                successMsg.style.color = '#28a745';
                successMsg.style.marginTop = '10px';
                successMsg.style.fontSize = '14px';
                container.appendChild(successMsg);
            }

            resetCrop(cropOverlay, initialX, initialY, initialWidth, initialHeight) {
                cropOverlay.style.left = initialX + 'px';
                cropOverlay.style.top = initialY + 'px';
                cropOverlay.style.width = initialWidth + 'px';
                cropOverlay.style.height = initialHeight + 'px';
            }

            generatePoster() {
                const loading = document.getElementById('loading');
                loading.classList.add('show');

                setTimeout(() => {
                    this.updateAllPosters();
                    this.createPreview();
                    loading.classList.remove('show');
                    document.getElementById('posterPreview').style.display = 'block';
                }, 100);
            }

            updateAllPosters() {
                // Update landscape poster
                const bgImg = document.getElementById('posterBG');
                bgImg.src = './Missioncc poster.jpg';

                for (let i = 1; i <= 3; i++) {
                    const authorName = document.getElementById(`author${i}`).value;
                    const pubText = document.getElementById(`pubText${i}`).value;
                    const linkText = document.getElementById(`link${i}`).value;

                    // Update landscape poster
                    const authorEl = document.getElementById(`authorText${i}`);
                    authorEl.innerHTML = `<span>${authorName}</span> ${pubText}`;

                    const finalLinkText = linkText.startsWith('#') ? linkText : '#' + linkText;
                    document.getElementById(`linkText${i}`).textContent = finalLinkText;

                    if (this.croppedImages[`publication${i}`]) {
                        document.getElementById(`pub${i}`).src = this.croppedImages[`publication${i}`];
                    }
                    if (this.croppedImages[`author${i}`]) {
                        document.getElementById(`auth${i}`).src = this.croppedImages[`author${i}`];
                    }

                    // Update portrait posters with portrait template
                    document.getElementById(`portraitBG${i}`).src = './missioncc_portrait.jpg';

                    const portraitAuthorEl = document.getElementById(`portraitAuthorText${i}`);
                    portraitAuthorEl.innerHTML = `<span>${authorName}</span> ${pubText}`;

                    document.getElementById(`portraitLinkText${i}`).textContent = finalLinkText;

                    if (this.croppedImages[`publication${i}`]) {
                        document.getElementById(`portraitPub${i}`).src = this.croppedImages[`publication${i}`];
                    }
                    if (this.croppedImages[`author${i}`]) {
                        document.getElementById(`portraitAuth${i}`).src = this.croppedImages[`author${i}`];
                    }
                }
            }

            createPreview() {
                const canvas = document.getElementById('posterCanvas');
                const previewScale = 0.2;
                canvas.width = 3508 * previewScale;
                canvas.height = 2480 * previewScale;

                // Create landscape preview
                html2canvas(document.getElementById('hiddenPoster'), {
                    useCORS: true,
                    allowTaint: true,
                    scale: previewScale,
                    width: 3508,
                    height: 2480
                }).then(canvas => {
                    const previewCanvas = document.getElementById('posterCanvas');
                    const ctx = previewCanvas.getContext('2d');
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(canvas, 0, 0);
                });

                // Create portrait previews
                const portraitPreviewScale = 0.15;
                for (let i = 1; i <= 3; i++) {
                    const portraitCanvas = document.getElementById(`portraitCanvas${i}`);
                    portraitCanvas.width = 1080 * portraitPreviewScale;
                    portraitCanvas.height = 1350 * portraitPreviewScale;

                    html2canvas(document.getElementById(`portraitPoster${i}`), {
                        useCORS: true,
                        allowTaint: true,
                        scale: portraitPreviewScale,
                        width: 1080,
                        height: 1350
                    }).then(canvas => {
                        const previewCanvas = document.getElementById(`portraitCanvas${i}`);
                        const ctx = previewCanvas.getContext('2d');
                        ctx.clearRect(0, 0, canvas.width, canvas.height);
                        ctx.drawImage(canvas, 0, 0);
                    });
                }
            }

            downloadLandscape() {
                const loading = document.getElementById('loading');
                loading.classList.add('show');

                setTimeout(() => {
                    html2canvas(document.getElementById('hiddenPoster'), {
                        useCORS: true,
                        allowTaint: true,
                        scale: 2,
                        width: 3508,
                        height: 2480
                    }).then(canvas => {
                        const link = document.createElement('a');
                        const link1 = document.getElementById('link1').value.replace('#', '');
                        const link2 = document.getElementById('link2').value.replace('#', '');
                        const link3 = document.getElementById('link3').value.replace('#', '');

                        const filename = `Mission CC ${link1} ${link2} ${link3}.jpg`;
                        link.download = filename;
                        link.href = canvas.toDataURL('image/jpeg');
                        link.click();
                        loading.classList.remove('show');
                    });
                }, 1000);
            }

            downloadPortrait(index) {
                const loading = document.getElementById('loading');
                loading.classList.add('show');

                setTimeout(() => {
                    html2canvas(document.getElementById(`portraitPoster${index}`), {
                        useCORS: true,
                        allowTaint: true,
                        scale: 2,
                        width: 1080,
                        height: 1350
                    }).then(canvas => {
                        const link = document.createElement('a');
                        const linkText = document.getElementById(`link${index}`).value.replace('#', '');
                        const authorName = document.getElementById(`author${index}`).value;

                        const filename = `Mission CC ${linkText} - ${authorName}.jpg`;
                        link.download = filename;
                        link.href = canvas.toDataURL('image/jpeg');
                        link.click();
                        loading.classList.remove('show');
                    });
                }, 1000);
            }

            async downloadAll() {
                const loading = document.getElementById('loading');
                loading.classList.add('show');

                try {
                    // Note: This creates individual downloads since ZIP creation requires additional libraries
                    // Download landscape
                    await this.downloadLandscapePromise();

                    // Download each portrait with delay
                    for (let i = 1; i <= 3; i++) {
                        await new Promise(resolve => setTimeout(resolve, 500));
                        await this.downloadPortraitPromise(i);
                    }

                    loading.classList.remove('show');
                    alert('All posters downloaded successfully!');
                } catch (error) {
                    loading.classList.remove('show');
                    alert('Error downloading posters: ' + error.message);
                }
            }

            downloadLandscapePromise() {
                return new Promise((resolve) => {
                    html2canvas(document.getElementById('hiddenPoster'), {
                        useCORS: true,
                        allowTaint: true,
                        scale: 2,
                        width: 3508,
                        height: 2480
                    }).then(canvas => {
                        const link = document.createElement('a');
                        const link1 = document.getElementById('link1').value.replace('#', '');
                        const link2 = document.getElementById('link2').value.replace('#', '');
                        const link3 = document.getElementById('link3').value.replace('#', '');

                        const filename = `Mission CC ${link1} ${link2} ${link3}.jpg`;
                        link.download = filename;
                        link.href = canvas.toDataURL('image/jpeg');
                        link.click();
                        resolve();
                    });
                });
            }

            downloadPortraitPromise(index) {
                return new Promise((resolve) => {
                    html2canvas(document.getElementById(`portraitPoster${index}`), {
                        useCORS: true,
                        allowTaint: true,
                        scale: 2,
                        width: 1080,
                        height: 1350
                    }).then(canvas => {
                        const link = document.createElement('a');
                        const linkText = document.getElementById(`link${index}`).value.replace('#', '');
                        const authorName = document.getElementById(`author${index}`).value;

                        const filename = `Mission CC ${linkText} - ${authorName}.jpg`;
                        link.download = filename;
                        link.href = canvas.toDataURL('image/jpeg');
                        link.click();
                        resolve();
                    });
                });
            }
        }

        function closeCropPopup() {
            const popup = document.getElementById('cropPopup');
            popup.classList.remove('show');
        }

        document.addEventListener('click', (e) => {
            const popup = document.getElementById('cropPopup');
            if (e.target === popup) {
                closeCropPopup();
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeCropPopup();
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            new PosterGenerator();
        });
    </script>
</body>

</html>
